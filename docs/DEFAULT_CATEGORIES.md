# Предустановленные категории

## Обзор

При регистрации нового пользователя автоматически создаётся расширенный набор предустановленных категорий для удобства начала работы с приложением. Категории организованы в иерархическую структуру с поддержкой до 3 уровней вложенности.

## Цветовая схема

### Принцип наследования цветов

- **Верхние категории** имеют уникальные цвета
- **Подкатегории** наследуют цвет от родительской категории (color = NULL)
- Все категории одного уровня имеют разные цвета для визуального различия

### Палитра цветов для верхних категорий

**Доходы (зелёные оттенки):**

- Зарплата: `#10b981`
- Премии: `#059669`
- Инвестиции: `#047857`
- Аренда недвижимости: `#065f46`
- Подарки: `#10b981`
- Прочие доходы: `#10b981`

**Расходы (различные оттенки):**

- Еда: `#ef4444` (красный)
- Транспорт: `#3b82f6` (синий)
- Жильё: `#a855f7` (фиолетовый)
- Здоровье: `#dc2626` (тёмно-красный)
- Развлечения: `#ec4899` (розовый)
- Образование: `#6366f1` (индиго)
- Покупки: `#f97316` (оранжевый)
- Одежда и обувь: `#ec4899` (розовый)
- Связь: `#3b82f6` (синий)
- Финансы: `#6366f1` (индиго)
- Красота и уход: `#ec4899` (розовый)
- Спорт и фитнес: `#10b981` (зелёный)
- Путешествия: `#3b82f6` (синий)
- Дети: `#f97316` (оранжевый)
- Домашние животные: `#f97316` (оранжевый)
- Бизнес: `#6366f1` (индиго)
- Налоги: `#ef4444` (красный)
- Подарки и благотворительность: `#a855f7` (фиолетовый)
- Прочие расходы: `#6b7280` (серый)

## Структура категорий

### Доходы (Income)

1. **Зарплата** (briefcase, #10b981)
2. **Премии** (gift, #059669)
3. **Инвестиции** (trending, #047857)
   - Дивиденды (dollar, наследует цвет)
   - Проценты по вкладам (banknote, наследует цвет)
   - Продажа активов (trending-up, наследует цвет)
4. **Аренда недвижимости** (home, #065f46)
   - Аренда квартиры (home, наследует цвет)
   - Аренда коммерческой недвижимости (building, наследует цвет)
5. **Подарки** (gift, #10b981)
6. **Прочие доходы** (wallet, #10b981)

### Расходы (Expense)

#### Основные категории:

1. **Еда** (food, #ef4444)
   - Продукты (shopping-bag, наследует цвет)
     - Мясо и птица (наследует цвет)
     - Рыба и морепродукты (наследует цвет)
     - Молочные продукты (наследует цвет)
     - Овощи (наследует цвет)
     - Фрукты (package, наследует цвет)
     - Ягоды (package, наследует цвет)
     - Хлеб и выпечка (наследует цвет)
     - Крупы и макароны (наследует цвет)
     - Консервы (наследует цвет)
     - Напитки (безалкогольные) (наследует цвет)
     - Сладости и десерты (наследует цвет)
     - Специи и приправы (наследует цвет)
     - Замороженные продукты (наследует цвет)
     - Детское питание (наследует цвет)
     - Прочие продукты (наследует цвет)
   - Рестораны и кафе (utensils, наследует цвет)
   - Доставка еды (package, наследует цвет)
   - Готовая еда (utensils-crossed, наследует цвет)
   - Алкоголь (наследует цвет)

2. **Транспорт** (car-front, #3b82f6)
   - Топливо (fuel, наследует цвет)
   - Общественный транспорт (bus, наследует цвет)
   - Обслуживание автомобиля (наследует цвет)
   - Страховка автомобиля (shield, наследует цвет)
   - Парковка (наследует цвет)
   - Такси (наследует цвет)

3. **Жильё** (home, #a855f7)
   - Аренда/Ипотека (home, наследует цвет)
   - Коммунальные платежи (zap, наследует цвет)
   - Ремонт и обслуживание (наследует цвет)
   - Мебель и интерьер (наследует цвет)
   - Бытовая техника (наследует цвет)
   - Хозяйственные товары (наследует цвет)
     - Туалетная бумага (package, наследует цвет)

4. **Здоровье** (heart-pulse, #dc2626)
   - Медицинские услуги (stethoscope, наследует цвет)
   - Лекарства (pill, наследует цвет)
   - Медицинское страхование (shield-check, наследует цвет)
   - Стоматология (наследует цвет)
   - Очки и контактные линзы (наследует цвет)

5. **Развлечения** (film, #ec4899)
   - Кино и театры (film, наследует цвет)
   - Игры и развлечения (gamepad, наследует цвет)
   - Хобби (palette, наследует цвет)
   - Подписки (стриминг, игры) (наследует цвет)
   - Концерты и мероприятия (music, наследует цвет)

6. **Образование** (graduation-cap, #6366f1)
   - Курсы и обучение (school, наследует цвет)
   - Книги и учебники (book, наследует цвет)
   - Онлайн-обучение (laptop, наследует цвет)
   - Канцелярские товары (наследует цвет)

7. **Покупки** (shopping, #f97316)
   - Электроника (smartphone, наследует цвет)
   - Книги и журналы (наследует цвет)
   - Подарки (gift, наследует цвет)

8. **Одежда и обувь** (shirt, #ec4899)
   - Одежда (shirt, наследует цвет)
   - Обувь (footprints, наследует цвет)
   - Аксессуары (наследует цвет)
   - Химчистка и ремонт (scissors, наследует цвет)

9. **Связь** (phone, #3b82f6)
   - Мобильная связь (smartphone, наследует цвет)
   - Интернет (wifi, наследует цвет)
   - Телевидение (наследует цвет)
   - Почтовые услуги (mail, наследует цвет)

10. **Финансы** (wallet, #6366f1)
    - Кредиты (credit-card, наследует цвет)
    - Проценты по кредитам (наследует цвет)
    - Банковские комиссии (receipt, наследует цвет)
    - Страхование (shield, наследует цвет)
    - Инвестиции (trending-up, наследует цвет)
    - Сбережения (наследует цвет)

11. **Красота и уход** (sparkles, #ec4899)
    - Косметика (palette, наследует цвет)
    - Парикмахерская (scissors, наследует цвет)
    - Спа и массаж (наследует цвет)
    - Косметология (sparkles, наследует цвет)

12. **Спорт и фитнес** (dumbbell, #10b981)
    - Спортивный зал (dumbbell, наследует цвет)
    - Спортивная одежда (shirt, наследует цвет)
    - Спортивное питание (apple, наследует цвет)
    - Тренер (наследует цвет)

13. **Путешествия** (plane, #3b82f6)
    - Авиабилеты (plane, наследует цвет)
    - Отели (наследует цвет)
    - Питание в поездках (utensils, наследует цвет)
    - Экскурсии и развлечения (camera, наследует цвет)
    - Сувениры (gift, наследует цвет)
    - Виза и документы (file-text, наследует цвет)

14. **Дети** (baby, #f97316)
    - Детская одежда (shirt, наследует цвет)
    - Детское питание (наследует цвет)
    - Игрушки (наследует цвет)
    - Образование детей (school, наследует цвет)
    - Кружки и секции (наследует цвет)
    - Детское здоровье (heart, наследует цвет)

15. **Домашние животные** (dog, #f97316)
    - Корм для животных (наследует цвет)
    - Ветеринарные услуги (stethoscope, наследует цвет)
    - Аксессуары для животных (наследует цвет)
    - Стрижка животных (scissors, наследует цвет)

16. **Бизнес** (briefcase, #6366f1)
    - Офис (building, наследует цвет)
    - Реклама (наследует цвет)
    - Оборудование (наследует цвет)
    - Канцелярия (наследует цвет)

17. **Налоги** (file-text, #ef4444)
    - Подоходный налог (receipt, наследует цвет)
    - Имущественный налог (home, наследует цвет)
    - Транспортный налог (car, наследует цвет)
    - Прочие налоги (file-text, наследует цвет)

18. **Подарки и благотворительность** (gift, #a855f7)
    - Подарки (gift, наследует цвет)
    - Благотворительность (наследует цвет)

19. **Прочие расходы** (wallet, #6b7280)

## Доступные иконки

Приложение поддерживает более 50 уникальных иконок из библиотеки lucide-react:

### Основные категории

- Home, ShoppingCart, ShoppingBag, Car, CarFront
- UtensilsCrossed, Utensils, Coffee, Heart, HeartPulse
- Gift, Wallet, CreditCard, Banknote, DollarSign
- TrendingUp, TrendingDown

### Транспорт

- Plane, Train, Bike, Bus, Fuel

### Развлечения и хобби

- Gamepad2, Music, Film, Camera, Palette
- Dumbbell, Trophy

### Образование и работа

- Book, GraduationCap, School, Briefcase, Building
- FileText, Calculator

### Здоровье и красота

- Stethoscope, Pill, Scissors, Sparkles

### Семья и животные

- Baby, Dog, Cat

### Технологии и связь

- Smartphone, Laptop, Wifi, Phone, Mail

### Прочее

- Tag, Star, Bell, Calendar, Clock
- MapPin, Package, Box, Receipt, Store
- Zap, Droplet, Flame, TreePine, Shirt
- Footprints, Umbrella, Sun, Moon

## Реализация

Категории создаются автоматически через триггер `on_profile_created_trigger` при создании профиля пользователя.

Функция `create_default_categories(UUID)` создаёт все предустановленные категории для указанного пользователя с правильной цветовой схемой и иерархией.

## Кастомизация

Пользователи могут:

- Редактировать названия категорий
- Изменять иконки и цвета
- Удалять ненужные категории (кроме системных)
- Создавать свои категории
- Добавлять подкатегории к существующим
- Наследовать цвета от родительских категорий (установив color = NULL)

## Миграция

Миграция находится в `supabase/migrations/20250128000000_update_categories_structure.sql`

Эта миграция:

- Обновляет функцию `create_default_categories` с новой структурой
- Устанавливает уникальные цвета для верхних категорий
- Устанавливает `color = NULL` для подкатегорий (наследование)
- Расширяет структуру категорий с дополнительными подкатегориями
- Обновляет существующие категории пользователей

## Для существующих пользователей

Цвета существующих категорий автоматически обновляются при применении миграции через функцию `update_existing_categories_colors()`.

Если нужно добавить предустановленные категории для уже существующих пользователей без категорий:

```sql
-- Для всех пользователей без категорий
DO $$
DECLARE
  user_record RECORD;
BEGIN
  FOR user_record IN
    SELECT id FROM profiles
    WHERE id NOT IN (SELECT DISTINCT user_id FROM categories)
  LOOP
    PERFORM create_default_categories(user_record.id);
  END LOOP;
END $$;
```
