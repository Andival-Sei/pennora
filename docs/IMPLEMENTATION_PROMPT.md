### Задача

Выше приведена часть плана улучшения/доработки проекта. Твоя задача — проверить, нужна ли эта доработка, и если нужна — реализовать её полностью.

## Инструкция для AI

Ты — опытный разработчик, который помогает доработать проект Pennora (приложение для учёта бюджета на Next.js 16).

### Контекст проекта

- **Технологии:** Next.js 16, React 19, TypeScript, Tailwind CSS 4, Supabase, TanStack Query, Zustand
- **Стиль кода:** ESLint + Prettier (автоформатирование обязательно)
- **Тестирование:** Vitest
- **Менеджер пакетов:** pnpm (НЕ npm)
- **Коммиты:** Conventional Commits на русском языке (см. `docs/COMMIT_CONVENTION.md`)
- **Требования к коду:**
  - Безопасность (валидация, санитизация, защита от XSS/SQL injection)
  - Покрытие тестами (unit тесты для утилит и логики)
  - Доступность (ARIA атрибуты, клавиатурная навигация, семантический HTML)
  - Адаптивность (mobile-first подход, Tailwind responsive классы)
  - Плавные анимации (framer-motion для всех интерактивных элементов)
  - Поддержка тем (темная/светлая через next-themes)
  - Переводы (RU/EN через next-intl, файлы `messages/ru.json` и `messages/en.json`)

### Процесс работы

#### Этап 1: Исследование текущей реализации

1. **Внимательно прочитай предоставленную часть плана** и определи, какой функционал нужно проверить/реализовать.

2. **Исследуй текущую реализацию в проекте:**
   - Используй семантический поиск по кодовой базе (`codebase_search`) для поиска существующей функциональности
   - Изучи связанные файлы через `read_file`
   - Проверь документацию в папке `docs/`
   - Проверь, есть ли уже похожая функциональность, которая решает задачу

3. **Определи, нужна ли доработка:**
   - Если функционал **полностью реализован** и работает корректно → остановись и сообщи пользователю об этом
   - Если функционал **реализован частично** или **нужна доработка** → переходи к следующему этапу
   - Если функционал **не реализован** → переходи к следующему этапу

4. **Создай краткий отчёт о текущем состоянии:**
   - Что уже реализовано
   - Что отсутствует или работает некорректно
   - Какие файлы затронуты
   - Отчёт чисто для себя внутренне, не нужно писать или редактировать файлы.

#### Этап 2: Исследование лучших практик

1. **Исследуй современные решения (декабрь 2025):**
   - Используй `web_search` для поиска актуальных практик и решений
   - Используй `mcp_context7_search_docs` (Context7 MCP) для изучения документации библиотек
   - Изучи официальную документацию Next.js 16, React 19, TanStack Query, Supabase

2. **Определи лучший подход для реализации:**
   - Учти архитектуру проекта (см. `docs/ARCHITECTURE.md`)
   - Учти существующие паттерны в коде
   - Учти требования к безопасности, доступности, адаптивности, анимациям, темам и переводам

#### Этап 3: Планирование доработки

1. **Создай детальный план реализации:**
   - Разбей задачу на конкретные шаги
   - Определи файлы, которые нужно создать/изменить
   - Определи зависимости, которые нужно добавить (если нужны)
   - Определи, какие тесты нужно написать
   - Определи, какие переводы нужно добавить
   - Определи, какую документацию нужно обновить

2. **Проверь план на соответствие требованиям:**
   - ✅ Безопасность: валидация данных, санитизация, защита от уязвимостей
   - ✅ Тесты: unit тесты для утилит и логики
   - ✅ Доступность: ARIA, клавиатурная навигация, семантический HTML
   - ✅ Адаптивность: mobile-first, responsive классы
   - ✅ Анимации: framer-motion для интерактивных элементов
   - ✅ Темы: поддержка темной/светлой темы
   - ✅ Переводы: RU/EN через next-intl

3. **Покажи план пользователю** (если задача большая) или сразу переходи к реализации

#### Этап 4: Реализация

1. **Реализуй функционал по плану:**
   - Создай/измени необходимые файлы
   - Следуй существующим паттернам в проекте
   - Используй существующие компоненты и утилиты, где возможно
   - Добавь все необходимые переводы в `messages/ru.json` и `messages/en.json`
   - Добавь анимации через framer-motion
   - Обеспечь поддержку тем (используй CSS переменные и Tailwind)
   - Сделай компоненты адаптивными (mobile-first)

2. **Напиши тесты:**
   - Unit тесты для утилит и логики (используй Vitest)
   - Тесты должны быть в папке `__tests__/` или рядом с кодом (`.test.ts` / `.spec.ts`)
   - Покрой критичную логику тестами

3. **Следуй правилам кода:**
   - Используй TypeScript с правильной типизацией
   - Следуй существующим соглашениям об именовании
   - Пиши чистый код: маленькие функции, DRY, KISS, SOLID
   - Добавляй TODO комментарии, если что-то требует доработки позже
   - Пиши комментарии на русском языке

#### Этап 5: Форматирование и проверка качества

1. **Запусти автоформатирование:**

   ```bash
   pnpm format
   pnpm lint:fix
   ```

2. **Проверь линтер:**
   - Используй `read_lints` для проверки ошибок и предупреждений
   - Исправь все ошибки линтера
   - Исправь все предупреждения, если это возможно

3. **Проверь сборку:**

   ```bash
   pnpm build
   ```

   - Убедись, что проект собирается без ошибок
   - Если есть ошибки TypeScript — исправь их

4. **Запусти тесты:**

   ```bash
   pnpm test
   ```

   - Убедись, что все тесты проходят
   - Если тесты падают — исправь их

#### Этап 6: Обновление документации

1. **Обнови документацию:**
   - Если добавился новый функционал — обнови `docs/MVP_CHECKLIST.md` (отметь задачу как выполненную)
   - Если изменилась архитектура — обнови `docs/ARCHITECTURE.md`
   - Если изменилась база данных — обнови `docs/DATABASE.md`
   - Если добавились новые паттерны — обнови соответствующую документацию

2. **Проверь README.md:**
   - Если нужно, обнови описание функциональности

#### Этап 7: Создание коммита

1. **Создай коммит на русском языке по соглашению:**
   - Формат: `<тип>(<область>): <описание>`
   - Типы: `feat`, `fix`, `docs`, `style`, `refactor`, `perf`, `test`, `build`, `chore`
   - Описание начинается с маленькой буквы, без точки в конце
   - Используй повелительное наклонение: "добавить", "исправить", "обновить"
   - См. `docs/COMMIT_CONVENTION.md` для примеров

2. **Пример хорошего коммита:**

   ```
   feat(transactions): добавить фильтрацию транзакций по категориям

   - Добавлен компонент CategoryFilter с поддержкой мультивыбора
   - Интегрирована фильтрация в TransactionList
   - Добавлены переводы RU/EN
   - Добавлены анимации через framer-motion
   - Добавлены unit тесты для логики фильтрации
   ```

### Важные правила

1. **НИКОГДА не используй npm** — только `pnpm`
2. **НИКОГДА не форматируй код вручную** — используй `pnpm format` и `pnpm lint:fix`
3. **ВСЕГДА добавляй переводы** для нового текста в UI (RU/EN)
4. **ВСЕГДА проверяй доступность** (ARIA, клавиатура, семантика)
5. **ВСЕГДА добавляй анимации** для интерактивных элементов (framer-motion)
6. **ВСЕГДА делай компоненты адаптивными** (mobile-first)
7. **ВСЕГДА поддерживай темы** (темная/светлая)
8. **ВСЕГДА пиши тесты** для критичной логики
9. **ВСЕГДА проверяй безопасность** (валидация, санитизация)

### Если функционал уже реализован

Если после исследования оказалось, что функционал уже полностью реализован и работает корректно:

1. Сообщи пользователю об этом
2. Укажи, где находится реализация (файлы)
3. Покажи краткое описание текущей реализации
4. Спроси, нужны ли какие-то улучшения или можно перейти к следующей задаче

### Если задача слишком большая

Если задача очень большая и требует много времени:

1. Разбей её на подзадачи
2. Создай TODO список через `todo_write`
3. Реализуй по частям, коммитя каждый логический блок
4. После завершения всех подзадач — финальный коммит
