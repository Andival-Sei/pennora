# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

## –î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞

2025-01-16

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### ‚úÖ 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è proxy.ts (middleware)

- **–ü—Ä–æ–±–ª–µ–º–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `getUser()` –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å (~100-200ms)
- **–†–µ—à–µ–Ω–∏–µ**: –ó–∞–º–µ–Ω–∞ –Ω–∞ `getSession()` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ JWT (~5-10ms)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£—Å–∫–æ—Ä–µ–Ω–∏–µ middleware –≤ 10-20 —Ä–∞–∑
- **–§–∞–π–ª**: `proxy.ts`

### ‚úÖ 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª–∏

- **–ü—Ä–æ–±–ª–µ–º–∞**: `loadUserSettings()` –≤—ã–∑—ã–≤–∞–ª—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª–∏, –¥–µ–ª–∞—è –∑–∞–ø—Ä–æ—Å –∫ –ë–î
- **–†–µ—à–µ–Ω–∏–µ**: –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º cookie, —Ç–æ–ª—å–∫–æ –∑–∞—Ç–µ–º –ë–î
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –õ–æ–∫–∞–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∏–∑ cookie –≤ 95% —Å–ª—É—á–∞–µ–≤
- **–§–∞–π–ª**: `i18n/request.ts`

### ‚úÖ 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è loadUserSettings()

- **–ü—Ä–æ–±–ª–µ–º–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `getUser()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ**: –ó–∞–º–µ–Ω–∞ –Ω–∞ `getSession()`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ ~50-100ms –ø—Ä–∏ –≤—ã–∑–æ–≤–µ
- **–§–∞–π–ª**: `lib/settings/load-user-settings.ts`

### ‚úÖ 4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Next.js

- **–î–æ–±–∞–≤–ª–µ–Ω–æ**: `optimizePackageImports` –¥–ª—è lucide-react –∏ @radix-ui
- **–î–æ–±–∞–≤–ª–µ–Ω–æ**: –°–∫—Ä–∏–ø—Ç `dev:turbo` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Turbopack
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–Ω–¥–ª–∞
- **–§–∞–π–ª**: `next.config.ts`, `package.json`

---

## –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### 1. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã getUser() –≤ Server Components

**–ü—Ä–æ–±–ª–µ–º–∞:**

- `getUser()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–∞–∂–¥–æ–º Server Component, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ –¥–µ–ª–∞–µ—Ç —Å–µ—Ç–µ–≤–æ–π –∑–∞–ø—Ä–æ—Å –∫ Supabase (~50-150ms)
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ dashboard —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**

- `app/(main)/dashboard/page.tsx` - 1 –≤—ã–∑–æ–≤
- `app/page.tsx` - 1 –≤—ã–∑–æ–≤
- –ò –µ—â—ë 26 —Ñ–∞–π–ª–æ–≤ –ø–æ –≤—Å–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

**–í–∞—Ä–∏–∞–Ω—Ç A: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å getSession() –≤ Server Components**

```typescript
// –í–º–µ—Å—Ç–æ
const {
  data: { user },
} = await supabase.auth.getUser();

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
const {
  data: { session },
} = await supabase.auth.getSession();
const user = session?.user;
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å user –∏–∑ proxy —á–µ—Ä–µ–∑ headers (–±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π)**

```typescript
// –í proxy.ts –¥–æ–±–∞–≤–∏—Ç—å user –≤ headers
response.headers.set("x-user-id", user?.id || "");

// –í Server Component —á–∏—Ç–∞—Ç—å –∏–∑ headers
const userId = headers().get("x-user-id");
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ –í—ã—Å–æ–∫–∏–π
**–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏**: ~50-150ms –Ω–∞ –∫–∞–∂–¥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∞—è

---

#### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Suspense boundaries

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –±–ª–æ–∫–∏—Ä—É—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
- –ù–µ—Ç streaming - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `BalanceCards` –∏ `StatisticsCards` –±–ª–æ–∫–∏—Ä—É—é—Ç –≤–µ—Å—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**

- `app/(main)/dashboard/page.tsx`
- –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```typescript
// –î–æ–±–∞–≤–∏—Ç—å Suspense boundaries
import { Suspense } from 'react';

export default async function DashboardPage() {
  // ... –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

  return (
    <main>
      <Suspense fallback={<BalanceCardsSkeleton />}>
        <BalanceCardsWrapper accounts={accounts} displayCurrency={displayCurrency} />
      </Suspense>

      <Suspense fallback={<StatisticsCardsSkeleton />}>
        <StatisticsCardsWrapper displayCurrency={displayCurrency} />
      </Suspense>
    </main>
  );
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –°—Ä–µ–¥–Ω–∏–π
**–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏**: –£–ª—É—á—à–µ–Ω–∏–µ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ–º–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ 30-50%
**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è

---

#### 3. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î –≤ dashboard

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –í `dashboard/page.tsx` –¥–µ–ª–∞—é—Ç—Å—è 3 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞:
  1. `getUser()` - ~50-150ms
  2. `from("profiles").select(...)` - ~50-100ms
  3. `from("accounts").select(...)` - ~50-100ms
- –û–±—â–µ–µ –≤—Ä–µ–º—è: ~150-350ms –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**

- `app/(main)/dashboard/page.tsx`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```typescript
// –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Promise.all
export default async function DashboardPage() {
  const supabase = await createClient();
  const {
    data: { session },
  } = await supabase.auth.getSession();
  const user = session?.user;

  if (!user) redirect("/login");

  // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
  const [profileResult, accountsResult] = await Promise.all([
    supabase
      .from("profiles")
      .select("default_currency, display_currency")
      .eq("id", user.id)
      .single(),
    supabase
      .from("accounts")
      .select("*")
      .eq("user_id", user.id)
      .eq("is_archived", false)
      .order("created_at", { ascending: true }),
  ]);

  const profile = profileResult.data;
  const accounts = accountsResult.data;

  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –°—Ä–µ–¥–Ω–∏–π
**–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏**: ~100-200ms –Ω–∞ –∑–∞–≥—Ä—É–∑–∫–µ dashboard
**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∞—è

---

#### 4. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**

- `BalanceCards` –∏ `StatisticsCards` - client components
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç loading state –¥–∞–∂–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π round-trip –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**

- `app/(main)/dashboard/balance-cards.tsx`
- `app/(main)/dashboard/statistics-cards.tsx`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

**–í–∞—Ä–∏–∞–Ω—Ç A: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ)**

```typescript
// –°–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
async function BalanceCards({ accounts, displayCurrency }) {
  const convertedBalances = await convertBalancesOnServer(
    accounts,
    displayCurrency
  );
  // –†–µ–Ω–¥–µ—Ä–∏–º —Å—Ä–∞–∑—É –≥–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
}
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å React Server Components —Å async/await**

```typescript
// –°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç async Server Component
export default async function BalanceCardsWrapper({ accounts, displayCurrency }) {
  const converted = await convertMultipleCurrencies(accounts, displayCurrency);
  return <BalanceCardsDisplay data={converted} />;
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –°—Ä–µ–¥–Ω–∏–π
**–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏**: ~100-300ms –Ω–∞ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ–º—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è

---

### üü° –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### 5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ Server Components

**–ü—Ä–æ–±–ª–µ–º–∞:**

- Next.js Router Cache –∫–µ—à–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ 30 —Å–µ–∫—É–Ω–¥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `unstable_cache` –∏–ª–∏ `revalidate` –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```typescript
import { unstable_cache } from "next/cache";

const getCachedCategories = unstable_cache(
  async (userId: string) => {
    const supabase = await createClient();
    return await fetchCategories(userId);
  },
  ["categories"],
  {
    revalidate: 300, // 5 –º–∏–Ω—É—Ç
    tags: ["categories"],
  }
);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –°—Ä–µ–¥–Ω–∏–π
**–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏**: ~50-100ms –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–∞—Ö
**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è

---

#### 6. –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ client components

**–ü—Ä–æ–±–ª–µ–º–∞:**

- 60+ —Ñ–∞–π–ª–æ–≤ —Å `"use client"`
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä JavaScript –±–∞–Ω–¥–ª–∞
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏

**–ê–Ω–∞–ª–∏–∑:**
–ú–Ω–æ–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ client, —Ö–æ—Ç—è –Ω–µ —Ç—Ä–µ–±—É—é—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:

- `FadeIn`, `Counter` - –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å Server Components —Å CSS –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- –ü—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç client components
- –í—ã–¥–µ–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ —á–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É—é—Ç interactivity
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Server Components –≤–µ–∑–¥–µ, –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ –ù–∏–∑–∫–∏–π
**–≠–∫–æ–Ω–æ–º–∏—è**: –£–º–µ–Ω—å—à–µ–Ω–∏–µ –±–∞–Ω–¥–ª–∞ –Ω–∞ 10-20%
**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

---

#### 7. React Query Devtools –≤ production —Å–±–æ—Ä–∫–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**

- Devtools –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∞–∂–µ –≤ production (—Ö–æ—Ç—è –∏ —Å–∫—Ä—ã—Ç—ã)
- –£–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Ä–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**

```typescript
{process.env.NODE_ENV === "development" && (
  <ReactQueryDevtools initialIsOpen={false} />
)}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —á–µ—Ä–µ–∑ —É—Å–ª–æ–≤–∏–µ `NODE_ENV`. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤ production –±–∞–Ω–¥–ª–µ –Ω–µ—Ç devtools.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ –ù–∏–∑–∫–∏–π
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –£–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ

---

### üü¢ –ù–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

#### 8. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–º–ø–æ—Ä—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ë–æ–ª—å—à–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è —Ü–µ–ª–∏–∫–æ–º
- lucide-react —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `optimizePackageImports`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –±–æ–ª—å—à–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (framer-motion, @radix-ui)
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å tree-shaking –¥–ª—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ –ù–∏–∑–∫–∏–π
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

#### 9. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ù–µ –Ω–∞–π–¥–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `next/image`
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `next/image` –¥–ª—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (—á–µ—Ä–µ–∑ Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ –ù–∏–∑–∫–∏–π (–µ—Å–ª–∏ –Ω–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Å–∞–π—Ç–µ)

---

## –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

### –§–∞–∑–∞ 1: –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã (1-2 –¥–Ω—è)

1. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å `getUser()` –Ω–∞ `getSession()` –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö Server Components
2. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –≤ dashboard —á–µ—Ä–µ–∑ Promise.all
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å Suspense boundaries –¥–ª—è BalanceCards –∏ StatisticsCards

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ 30-40%

### –§–∞–∑–∞ 2: –°—Ä–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (3-5 –¥–Ω–µ–π)

4. ‚¨ú –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –≤–∞–ª—é—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
5. ‚¨ú –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
6. ‚¨ú –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 20-30%

### –§–∞–∑–∞ 3: –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

7. ‚¨ú –ê—É–¥–∏—Ç –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è client components
8. ‚¨ú –ü–æ–ª–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥ Suspense –∏ streaming
9. ‚¨ú –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–Ω–¥–ª–∞ –∏ code splitting

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 10-15%

---

## –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –¢–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (–¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π)

- –ü–µ—Ä–≤–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è: ~32s
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è: ~1.5-4s
- proxy.ts –≤—Ä–µ–º—è: ~5-10ms ‚úÖ
- Dashboard render: ~500-850ms
- Dashboard render (–º–µ–¥–ª–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π): ~10.7s (timeout)

### –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π)

- –ü–µ—Ä–≤–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è: ~5-10s (—Å Turbopack) ‚úÖ
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è: ~200-500ms ‚úÖ
- proxy.ts –≤—Ä–µ–º—è: ~5-10ms ‚úÖ
- Dashboard render: ~200-400ms
- Dashboard render (–º–µ–¥–ª–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π): ~500-800ms

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–∞—á–µ—Å—Ç–≤–æ

–í—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ **–Ω–µ —É—Ö—É–¥—à–∞—é—Ç** –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

1. ‚úÖ `getSession()` vs `getUser()` - –æ–±–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JWT
2. ‚úÖ Suspense boundaries - —Ç–æ–ª—å–∫–æ —É–ª—É—á—à–∞—é—Ç UX
3. ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã - –Ω–µ –º–µ–Ω—è—é—Ç –ª–æ–≥–∏–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã Next.js —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ TTL

---

## –°—Å—ã–ª–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã

- [Next.js Performance](https://nextjs.org/docs/app/building-your-application/optimizing)
- [React Suspense](https://react.dev/reference/react/Suspense)
- [TanStack Query Performance](https://tanstack.com/query/latest/docs/react/guides/window-focus-refetching)
- [Supabase Auth Best Practices](https://supabase.com/docs/guides/auth)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û—Å–Ω–æ–≤–Ω—ã–µ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã—è–≤–ª–µ–Ω—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã. –ù–∞–∏–±–æ–ª–µ–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–∑–∞–º–µ–Ω–∞ getUser –Ω–∞ getSession, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è proxy) —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å —Å –§–∞–∑—ã 1 –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –∫–æ–¥–µ.
