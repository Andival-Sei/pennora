# Миграции базы данных

## Применение миграций

### Через Supabase Dashboard

1. Откройте Supabase Dashboard
2. Перейдите в SQL Editor
3. Скопируйте содержимое файла миграции
4. Выполните SQL запрос

### Через Supabase CLI

```bash
# Применить все миграции
supabase db push

# Или применить конкретную миграцию
supabase migration up 20250101000000_create_default_categories
```

## Миграции

### 20250101000000_create_default_categories.sql

Создаёт предустановленные категории для новых пользователей.

**Что делает:**

- Создаёт функцию `create_default_categories(UUID)` для создания набора категорий
- Модифицирует триггер `on_auth_user_created` для автоматического создания категорий при регистрации

**Категории:**

- 4 категории доходов
- 8 основных категорий расходов
- 7 подкатегорий (для Еды, Транспорта, Жилья)

**Безопасность:**

- Использует `ON CONFLICT DO NOTHING` для профилей
- Проверяет наличие категорий перед созданием
- Не создаёт дубликаты
